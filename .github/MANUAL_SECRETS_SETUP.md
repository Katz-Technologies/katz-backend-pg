# –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Secrets –≤ GitHub

## üìç –ì–¥–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å secrets

–í –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **Environment secrets** –¥–ª—è `staging` –∏ `production` environments.

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è: `https://github.com/Froloveee3/katz-backend-pg`
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É **Settings** (–≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
3. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **Secrets and variables** ‚Üí **Actions**
4. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ **Environments** (–∏–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞–ø—Ä—è–º—É—é: `https://github.com/Froloveee3/katz-backend-pg/settings/environments`)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Staging Environment

1. –ù–∞–π–¥–∏—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ environment **`staging`**
2. –í —Ä–∞–∑–¥–µ–ª–µ **Environment secrets** –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Add secret**
3. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ secrets:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ secrets –¥–ª—è staging:

| Secret Name | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| `SSH_HOST` | `51.250.122.192` | IP –∞–¥—Ä–µ—Å stage —Å–µ—Ä–≤–µ—Ä–∞ |
| `SSH_USER` | `ubuntu` (–∏–ª–∏ –≤–∞—à username) | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è SSH |
| `SSH_PRIVATE_KEY` | `<—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞>` | –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ SSH –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ |
| `SSH_PORT` | `22` | –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22) |
| `DEPLOY_PATH` | `/home/ubuntu/katz-backend` | –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –¥–µ–ø–ª–æ—è |

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ secrets:

| Secret Name | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| `GIT_TOKEN` | `<GitHub token>` | GitHub token –¥–ª—è HTTPS –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è SSH) |
| `STAGING_URL` | `http://51.250.122.192:3000` | URL –¥–ª—è health checks |

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å SSH_PRIVATE_KEY:**
- –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á (–æ–±—ã—á–Ω–æ `~/.ssh/id_rsa` –∏–ª–∏ `~/.ssh/id_ed25519`)
- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–≤—Å—ë —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ** —Ñ–∞–π–ª–∞ (–≤–∫–ª—é—á–∞—è —Å—Ç—Ä–æ–∫–∏ `-----BEGIN ... KEY-----` –∏ `-----END ... KEY-----`)
- –í—Å—Ç–∞–≤—å—Ç–µ –≤ –ø–æ–ª–µ –∑–Ω–∞—á–µ–Ω–∏—è secret

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Production Environment

1. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ —Å–ø–∏—Å–∫—É environments (–∫–Ω–æ–ø–∫–∞ **‚Üê Environments**)
2. –ù–∞–π–¥–∏—Ç–µ –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ environment **`production`**
3. –í —Ä–∞–∑–¥–µ–ª–µ **Environment secrets** –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **Add secret**
4. –î–æ–±–∞–≤—å—Ç–µ —Ç–µ –∂–µ secrets, –Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ secrets –¥–ª—è production:

| Secret Name | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| `SSH_HOST` | `51.250.50.213` | IP –∞–¥—Ä–µ—Å production —Å–µ—Ä–≤–µ—Ä–∞ |
| `SSH_USER` | `ubuntu` (–∏–ª–∏ –≤–∞—à username) | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è SSH |
| `SSH_PRIVATE_KEY` | `<—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞>` | –ü–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ SSH –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ—Ç –∂–µ, —á—Ç–æ –∏ –¥–ª—è staging) |
| `SSH_PORT` | `22` | –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22) |
| `DEPLOY_PATH` | `/home/ubuntu/katz-backend` | –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–ª—è –¥–µ–ø–ª–æ—è |

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ secrets:

| Secret Name | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|----------|----------|
| `GIT_TOKEN` | `<GitHub token>` | GitHub token –¥–ª—è HTTPS –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è |
| `PRODUCTION_URL` | `http://51.250.50.213:3000` | URL –¥–ª—è health checks |

## üìù –ë—ã—Å—Ç—Ä–∞—è —Å—Å—ã–ª–∫–∞

–ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É environments:
```
https://github.com/Froloveee3/katz-backend-pg/settings/environments
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö secrets

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ secrets –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Ö –Ω–∞–ª–∏—á–∏–µ:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Secrets and variables** ‚Üí **Actions** ‚Üí **Environments**
2. –í—ã–±–µ—Ä–∏—Ç–µ environment (`staging` –∏–ª–∏ `production`)
3. –í —Ä–∞–∑–¥–µ–ª–µ **Environment secrets** –≤—ã —É–≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö secrets (–Ω–æ –Ω–µ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ù–µ–ª—å–∑—è –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è secrets** –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ - GitHub –∏—Ö —à–∏—Ñ—Ä—É–µ—Ç
2. **–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è secret** - —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ –∑–∞–Ω–æ–≤–æ —Å –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
3. **SSH –∫–ª—é—á –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenSSH**:
   - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `-----BEGIN OPENSSH PRIVATE KEY-----` –∏–ª–∏
   - `-----BEGIN RSA PRIVATE KEY-----` –∏–ª–∏
   - `-----BEGIN EC PRIVATE KEY-----`
4. **–û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ SSH –∫–ª—é—á** –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–æ–∏—Ö environments, –µ—Å–ª–∏ —É –≤–∞—Å –æ–¥–∏–Ω –∫–ª—é—á –¥–ª—è –æ–±–æ–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤

## üÜò Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: "Secret not found" –≤ workflow

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ secret –¥–æ–±–∞–≤–ª–µ–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π environment (`staging` –∏–ª–∏ `production`)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π environment:
  ```yaml
  environment:
    name: staging  # –∏–ª–∏ production
  ```

### –ü—Ä–æ–±–ª–µ–º–∞: "Permission denied" –ø—Ä–∏ SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `SSH_PRIVATE_KEY` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ `~/.ssh/authorized_keys`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ü—Ä–æ–±–ª–µ–º–∞: "Environment not found"

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ environments `staging` –∏ `production` —Å–æ–∑–¥–∞–Ω—ã
- –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ –∏—Ö –≤ **Settings** ‚Üí **Environments** ‚Üí **New environment**

## üìã –ß–µ–∫-–ª–∏—Å—Ç

### Staging Environment:
- [ ] `SSH_HOST` = `51.250.122.192`
- [ ] `SSH_USER` = (–≤–∞—à username)
- [ ] `SSH_PRIVATE_KEY` = (—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞)
- [ ] `SSH_PORT` = `22`
- [ ] `DEPLOY_PATH` = `/home/ubuntu/katz-backend`
- [ ] `GIT_TOKEN` = (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `STAGING_URL` = (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Production Environment:
- [ ] `SSH_HOST` = `51.250.50.213`
- [ ] `SSH_USER` = (–≤–∞—à username)
- [ ] `SSH_PRIVATE_KEY` = (—Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–ª—é—á–∞)
- [ ] `SSH_PORT` = `22`
- [ ] `DEPLOY_PATH` = `/home/ubuntu/katz-backend`
- [ ] `GIT_TOKEN` = (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `PRODUCTION_URL` = (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

