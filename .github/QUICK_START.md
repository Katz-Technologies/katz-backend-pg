# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç CI/CD

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏:

### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Secrets (Settings ‚Üí Secrets and variables ‚Üí Actions)

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

| –°–µ–∫—Ä–µ—Ç | –ß—Ç–æ —É–∫–∞–∑–∞—Ç—å |
|--------|-------------|
| `SSH_HOST` | IP –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ |
| `SSH_USER` | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è SSH (–Ω–∞–ø—Ä–∏–º–µ—Ä: `ubuntu`, `root`) |
| `SSH_PRIVATE_KEY` | –ü—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á (—Å–º. –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –Ω–∏–∂–µ) |
| `SSH_PORT` | –ü–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ `22`, –º–æ–∂–Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞—Ç—å) |
| `DEPLOY_PATH` | –ü—É—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `/home/ubuntu/katz-backend`) |
| `GIT_TOKEN` | GitHub Personal Access Token (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ SSH, –¥–ª—è HTTPS) |

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è SSH –∫–ª—é—á–∞:**
```bash
ssh-keygen -t ed25519 -C "github-actions" -f ~/.ssh/github_actions_deploy
ssh-copy-id -i ~/.ssh/github_actions_deploy.pub user@your-server
cat ~/.ssh/github_actions_deploy  # –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å –≤—ã–≤–æ–¥ –≤ SSH_PRIVATE_KEY
```

### 2. –°–æ–∑–¥–∞–π—Ç–µ Environment (Settings ‚Üí Environments)

1. –ù–∞–∂–º–∏—Ç–µ `New environment`
2. –ò–º—è: `production`
3. (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤—å—Ç–µ —Ç–µ –∂–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Environment secrets

### 3. –í—ã–±–µ—Ä–∏—Ç–µ workflow –¥–ª—è –¥–µ–ø–ª–æ—è

- **deploy.yml** - –¥–ª—è –ø—Ä—è–º–æ–≥–æ –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Node.js/PM2
- **deploy-docker.yml** - –¥–ª—è –¥–µ–ø–ª–æ—è —á–µ—Ä–µ–∑ Docker

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ Docker –ª–æ–∫–∞–ª—å–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `deploy-docker.yml`.

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

### –î–ª—è –ø—Ä—è–º–æ–≥–æ –¥–µ–ø–ª–æ—è (deploy.yml):

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js 20.x –∏ PM2
2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/home/ubuntu/katz-backend`
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è (—Å–º. `.github/SETUP_CHECKLIST.md`)
4. –°–æ–∑–¥–∞–π—Ç–µ `ecosystem.config.js` –¥–ª—è PM2 (—Å–º. `.github/SETUP_CHECKLIST.md`)

### –î–ª—è Docker –¥–µ–ø–ª–æ—è (deploy-docker.yml):

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker, Docker Compose –∏ Git
2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `/home/ubuntu/katz-backend`
3. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —ç—Ç–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
4. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –¥–µ–ø–ª–æ–µ

**–í–∞–∂–Ω–æ:** 
- –î–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤: –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Å–º. `.github/SETUP_CHECKLIST.md`) –ò–õ–ò –¥–æ–±–∞–≤—å—Ç–µ `GIT_TOKEN` –≤ GitHub Secrets
- –î–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤: –Ω–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã:

1. –°–æ–∑–¥–∞–π—Ç–µ PR –∏–∑ `dev` –≤ `main`
2. –ü–æ—Å–ª–µ –º–µ—Ä–¥–∂–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –¥–µ–ø–ª–æ–π
3. –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Ä—É—á–Ω—É—é: `Actions` ‚Üí `Deploy to Production` ‚Üí `Run workflow`

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:

- –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `.github/DEPLOYMENT.md`
- –ü–æ—à–∞–≥–æ–≤—ã–π —á–µ–∫–ª–∏—Å—Ç: `.github/SETUP_CHECKLIST.md`

